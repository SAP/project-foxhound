function strSplitTest() {
    var a = 'Hello ';
    var b = taint('tainted');
    var c = ' World!';
    var str = a + b + c;
    // Test basic string splitting
    var parts = str.split(' ');
    assertLastTaintOperationEquals(parts[1], "split");
    assertEqualTaint(parts[1], b);
    assertNotHasTaintOperation(str, 'split');
}

function strSplitTestArray() {
    var a = 'Hello ';
    var b = taint('tainted');
    var c = ' World!';
    var str = a + b + c;

    // Test splitting into character array
    var parts = str.split('');
    assertLastTaintOperationEquals(parts[6], "split");
    assertEqualTaint(parts[6], b[0]);
    assertNotHasTaintOperation(str, 'split');
}

function strSplitTestRegex() {
    var a = 'Hello ';
    var b = taint('tainted');
    var c = ' World!';
    var str = a + b + c;

    // Test regex string splitting
    parts = str.split(/\s/);
    assertEqualTaint(parts[1], b);
    assertNotHasTaintOperation(str, 'split');
}

function largeCommaSplit() {
    var filters = '.green-token.io,innovation.fieldglass.com,.cdp.cloud.sap,www.saphybriscloud.cn,project-piper.io,.entlms.cloud.sap,.dws.ondemand.com,www.coresystems.net,www.concurcdc.cn,www.concur.com.au,www.concur.com,www.concur.cn,www.concur.be,www.concur.co.in,.businessbydesign.cloud.sap,sap.github.io/cloud-sdk/,sap-alumni.com,sap.willhire.co,iccsrm.sap.com,luigi-project.io,b1worldwide.com,www.brillianthire.io,.ems.cn40.apps.platform.sapcloud.cn,ui5.sap.com,apphaus.sap.com,.gardener.cloud,xml.cxml.org,search.sap.com,eventisap.it,www.cxml.org,cx.sap-israel.co.il,www.sapjp.com,fm.sap.com,www.paidpronto.io,businesstransformationtour.com,.sapmachine.io,.nwep.dev.sap,scmibp.cn,sapibp.cn,www.saps4hanacloud.cn,www.ruumapp.com,messages.sap.com,blogs.sap.com,fieldglass.ae,tw.events.sap.com,.workzone.ondemand.com,forums.appgyver.com,www.sap-press.com,groups.community.sap.com,consolidation.community.sap.com,irpa.store.sap.com,sqlanywhere-forum.sap.com/,s4bounty.ondemand.com,sapforgrowth.com,sap-enable-now.cn,manufacturing.businesstransformationtour.com/,financial-services.businesstransformationtour.com/,government.businesstransformationtour.com/,uae.businesstransformationtour.com/,healthcare.businesstransformationtour.com/,ksa.businesstransformationtour.com/,automotive.businesstransformationtour.com/,enr.businesstransformationtour.com/,consumer.businesstransformationtour.com/,africa.businesstransformationtour.com/,utilities.businesstransformationtour.com/,italy.businesstransformationtour.com/,telco.businesstransformationtour.com/,retail.businesstransformationtour.com/,spain.businesstransformationtour.com/,www.build.me,open.sap.com,turkey.businesstransformationtour.com/,executive.businesstransformationtour.com,discover.sap.com,www.getfeather.io,cai.tools.sap,microlearning.opensap.com,answers.sap.com/index.html,pilot.support.sap.com,www.get-encore.io/,api.sap.com,tools.hana.ondemand.com,.training.sap.com,developers.sap.com,qualtrics.com,wiki.scn.sap.com,store.sap.com,www.sapsf.cn,learninghub.sap.com,www.sapmerchandise.com,viviendoconunclevel.com,event.on24.com,awardscampaigns.hana.ondemand.com/,cockpit.*.hana.ondemand.com,help.sap.com,emarsys.com,.tradeclaims.cloud.sap,fioriappslibrary.hana.ondemand.com/,github.com/sap-linuxlab,.businessbydesign.sapcloud.cn,developer.concur.com,sap.github.io/ui5-webcomponents-react/,.cld.ondemand.com,activities.sap.com,community.sap.com,sportsone.cloud.sap,sap.github.io/ui5-tooling/,cdn.industry.cloud.sap,commissions.cloud.sap,sap.github.io/sapmachine/,www.sap-tv.com,sap-israel.co.il,sap-israel.co.il/cloud-erp-digital-core/byd/,procurement-planning.ondemand.com,smc-lp.s4hana.ondemand.com,smc-link.s4hana.ondemand.com/,smc-reco.s4hana.ondemand.com,smc-seb.s4hana.ondemand.com,store.irpa.cfapps.eu10.hana.ondemand.com,sap.github.io/spartacus-docs/,www.sapterm.com,forms.services.sap.com,events.sap.cn,www.the-future-of-commerce.com,sap.io,www.sapsailing.com,cap.cloud.sap,try-me.sap.com,me.sap.com,me.sap.cn,www.coronawarn.app/,www.sapbrandtools.com,scmibp1.ondemand.com,scmibp.ondemand.com,cla-assistant.io,sapcenter.com,community.concur.com,www.sapdigitalinterconnect.com,rapid.sap.com,www.concur.com.br,www.concur.ca,www.concur.dk,www.concur.fr,www.concur.de,www.concur.com.hk,www.concur.it,www.concur.co.jp,www.concur.kr,www.concur.com.mx,www.concur.nl,www.concur.no,www.concur.co.za,www.concur.es,www.concur.se,www.concur.co.uk,www.concur.com.sg,fundamentalconf.com,sqlasupport.sap.com/update_checker,courseducoeur.enter.sap,resolve.sap.com,videos.netshow.me,applicationstudio.sapcloud.cn,dcx.sap.com,career8.successfactors.com,go.support.sap.com,www.b-forum.net,www.green-token.io,.cp.iot.sap,hyperfair.com,events.sap.com,support.sap.com,www.wjx.cn,account.hana.ondemand.com,www.sap-latam.com,www.pathfactory.com,sapengineering.academy,orientdb.org,sap.scherer-event.com,www.sapevents.com,partner.store.sap.com,jobs.sap.com,relief.io,softwaredownloads.sap.com,saparena.de,salesselector.com,salesjibe.com,.learn.sap,s4hanaopp.com,gigyademo.com,sapvirtualevents.com,www.sapnow.com.br,orientdb.com,concur.com,fieldglass.com,gigya.com,successfactors.eu,sapanalytics.cloud,sapandasug.com,jam4.sapjam.com,saps4hanahub.com,sap.wegone.com,sapsupport.info,sapforum.it,sapappsdevelopmentpartnercenter.com,aribalive.com,concur.cn,concur.co.jp,concur.co.uk,concur.com.sg,sapsf.eu,mailsap.com,sapbydesign.com,yaas.io,sapsf.com,sapdigital.com,sapbusinessobjects.cloud,workconnect.io,digital.sap.com,sap.to,growthmattersnetwork.com,saplumira.com,sapappcenter.com,digitalistmag.com,hybris.com,the-future-of-commerce.com,sapmobileconsumertrends.com,sapeducationsolutions.com,sapns2.com,streamwork.com,sapstreamwork.com,aboutsapcampbell.com,analytics-usa.com,estara.com,businessobjects.com,businessobjects.com.pl,business-objects.com.pl,businessobjects.pl,business-objects.pl,careersatsap.com,cfolder.de,cfolders.com,cfolders.de,cfolders.net,crystalreports.com,digitalriver.com,edusap.at,fazi.at,fazi.com,fazi.de,futurefactoryinitiative.com,futurefactoryinitiative.org,fuzzy.at,fuzzy.ch,fuzzy-informatik.com,fuzzy-informatik.de,fuzzy-online.com,fuzzy-online.de,infommersion.com,ondemand.com,sap.at,sap.bg,sap.biz,sap.ca,sap.ch,sap.cl,sap.cn,sap.co.at,sap.co.il,sap.co.jp,sap.co.kr,sap.co.nz,sap.co.th,sap.co.uk,sap.co.za,sap.com,sap.com.au,sap.com.cn,sap.com.pl,sap.com.sg,sap.com.tr,sap.com.tw,sap.cz,sap.de,sap.ee,sap.fi,sap.hk,sap.hr,sap.hu,sap.ie,sap.in,sap.info,sap.kz,sap.lu,sap.nl,sap.pl,sap.pt,sap.ro,sap.ru,sap.si,sap.sk,sap.tw,sap.ua,sap.us,sapag.de,sap-ag.de,sapamerica.com,sap-answer.com,sap-austria.com,sap-best-fit-adviser.com,sapbusinessbydesign.cn,sapbusinessbydesign.co.uk,sapbusinessbydesign.com,sapbusinessbydesign.de,sapbusinessbydesign.us,sapbusinessobjects.com.pl,sap-business-objects.com.pl,sapbusinessobjects.pl,sap-business-objects.pl,sapbusinessobjectsresponses.com,sapbusinessone.pl,sap-campbell.com,sapcampbell.net,sapcampbell.org,sapchina.com,sapclear.com,sapconfigurator.com,sapdesignguild.org,sap-event.jp,sapevents.com,sap-forum.de,sap-insights.com,sapkhimetrics.com,saplabs.bg,saplabs.co.in,saplabs.fr,saplabs.in,sapnetweaver.com,sapphirenow.com,sap-retail.de,sapsapphire.com,sapsem.com,sap-spectrum.com,sapteched.com,sapthai.com,sapturkiye.com.tr,sap-tv.com,sapventures.com,sapworldtour.com,sapworldtour2010.com,steeb.de,sap.corp,saplabs.com,sybase.com,sappartneredge.eu,sapbusinessinthemoment.com,sapbusinessoptimizer.com,sapcampaigns.com,sapcfo.com,sapcpg.com,sapcrystalconfigurator.com,SAPEnterpriseMobility.mobi,sapevent.ch,sapfinancialservices.com,sapforumbimadrid2011.com,sap-im-dialog.com,sap-innovationnow.com,sap-it-leadership.com,sappartnermobileapps.com,sap-readytoboost.com,sapretailtoday.com,saprunprouder.com,sapsponsorships.com,sapstrategichr.com,sapsurvey.com,sapsustainabilitytoday.com,saputilitiestoday.com,sap-webseminare.de,iqformarketers.com,sybase.be,sybase.ca,sybase.ch,sybase.co.kr,sybase.co.uk,sybase.com.ar,sybase.com.au,sybase.com.br,sybase.com.cn,sybase.com.hk,sybase.com.mx,sybase.com.tw,sybase.de,sybase.dk,sybase.es,sybase.fr,sybase.hu,sybase.in,sybase.it,sybase.jp,sybase.nl,sybase.no,sybase.se,sybase365.com,sappartneredge.com,ariba.com,saphana.com,saphanacouncil.com,saphanapartnerrace.com,successfactors.co.kr,successfactors.com,successfactors.com.br,successfactors.com.cn,successfactors.de,successfactors.es,successfactors.jp,successfactors.nl,successfactors.se,sybase.asia,sybase.at,SYBASE.BIZ,sybase.co.at,sybase.co.hu,sybase.co.it,sybase.co.jp,sybase.co.ma,sybase.co.nz,sybase.co.za,sybase.com.ec,sybase.com.es,sybase.com.gr,sybase.com.my,sybase.com.pe,sybase.com.pk,sybase.com.pl,sybase.com.ro,sybase.com.sg,sybase.com.ve,sybase.cz,sybase.ec,sybase.ee,sybase.eu,sybase.hk,sybase.ie,sybase.info,sybase.li,sybase.lu,sybase.mobi,SYBASE.ORG,sybase.ph,sybase.pl,sybase.tw,sybase.us,sybasesolutions.net,syclo.co.uk,syclo.com,syclo.com.br,syclo.de,syclo.es,syclo.it,syclo.mobi,gainthevisibleadvantage.com,getconnected-sap.co.uk,myrunwayapp.com,sapafaria.com,saparpfasttrack.com,sapbusinessonnesolutions.com,sapcloudappspartnercenter.com,sapcustomerexerience.com,sapcycle4youth.com,sapdashboardgallery.com,sapdatacentertour.com,sapdatachallenge.com,sap-milestones.com,sap-milestones.de,sapmobileappspartnercenter.com,sapmobileservices.com,sapmobiletransformation.com,sap-sybase-ase.com,sap-sybase-iq.com,stepaheadwithsap.com,thinkbiggrowfast.net,sapbusinessobjectsbi.com,sapbigdata.com,www.sap.com'
    var a = filters.split(',');
    for (var i in a) {
        assertNotTainted(a[i]);
    }
}

function largeCommaSplitTainted() {
    var filters = '.green-token.io,innovation.fieldglass.com,.cdp.cloud.sap,www.saphybriscloud.cn,project-piper.io,.entlms.cloud.sap,.dws.ondemand.com,www.coresystems.net,www.concurcdc.cn,www.concur.com.au,www.concur.com,www.concur.cn,www.concur.be,www.concur.co.in,.businessbydesign.cloud.sap,sap.github.io/cloud-sdk/,sap-alumni.com,sap.willhire.co,iccsrm.sap.com,luigi-project.io,b1worldwide.com,www.brillianthire.io,.ems.cn40.apps.platform.sapcloud.cn,ui5.sap.com,apphaus.sap.com,.gardener.cloud,xml.cxml.org,search.sap.com,eventisap.it,www.cxml.org,cx.sap-israel.co.il,www.sapjp.com,fm.sap.com,www.paidpronto.io,businesstransformationtour.com,.sapmachine.io,.nwep.dev.sap,scmibp.cn,sapibp.cn,www.saps4hanacloud.cn,www.ruumapp.com,messages.sap.com,blogs.sap.com,fieldglass.ae,tw.events.sap.com,.workzone.ondemand.com,forums.appgyver.com,www.sap-press.com,groups.community.sap.com,consolidation.community.sap.com,irpa.store.sap.com,sqlanywhere-forum.sap.com/,s4bounty.ondemand.com,sapforgrowth.com,sap-enable-now.cn,manufacturing.businesstransformationtour.com/,financial-services.businesstransformationtour.com/,government.businesstransformationtour.com/,uae.businesstransformationtour.com/,healthcare.businesstransformationtour.com/,ksa.businesstransformationtour.com/,automotive.businesstransformationtour.com/,enr.businesstransformationtour.com/,consumer.businesstransformationtour.com/,africa.businesstransformationtour.com/,utilities.businesstransformationtour.com/,italy.businesstransformationtour.com/,telco.businesstransformationtour.com/,retail.businesstransformationtour.com/,spain.businesstransformationtour.com/,www.build.me,open.sap.com,turkey.businesstransformationtour.com/,executive.businesstransformationtour.com,discover.sap.com,www.getfeather.io,cai.tools.sap,microlearning.opensap.com,answers.sap.com/index.html,pilot.support.sap.com,www.get-encore.io/,api.sap.com,tools.hana.ondemand.com,.training.sap.com,developers.sap.com,qualtrics.com,wiki.scn.sap.com,store.sap.com,www.sapsf.cn,learninghub.sap.com,www.sapmerchandise.com,viviendoconunclevel.com,event.on24.com,awardscampaigns.hana.ondemand.com/,cockpit.*.hana.ondemand.com,help.sap.com,emarsys.com,.tradeclaims.cloud.sap,fioriappslibrary.hana.ondemand.com/,github.com/sap-linuxlab,.businessbydesign.sapcloud.cn,developer.concur.com,sap.github.io/ui5-webcomponents-react/,.cld.ondemand.com,activities.sap.com,community.sap.com,sportsone.cloud.sap,sap.github.io/ui5-tooling/,cdn.industry.cloud.sap,commissions.cloud.sap,sap.github.io/sapmachine/,www.sap-tv.com,sap-israel.co.il,sap-israel.co.il/cloud-erp-digital-core/byd/,procurement-planning.ondemand.com,smc-lp.s4hana.ondemand.com,smc-link.s4hana.ondemand.com/,smc-reco.s4hana.ondemand.com,smc-seb.s4hana.ondemand.com,store.irpa.cfapps.eu10.hana.ondemand.com,sap.github.io/spartacus-docs/,www.sapterm.com,forms.services.sap.com,events.sap.cn,www.the-future-of-commerce.com,sap.io,www.sapsailing.com,cap.cloud.sap,try-me.sap.com,me.sap.com,me.sap.cn,www.coronawarn.app/,www.sapbrandtools.com,scmibp1.ondemand.com,scmibp.ondemand.com,cla-assistant.io,sapcenter.com,community.concur.com,www.sapdigitalinterconnect.com,rapid.sap.com,www.concur.com.br,www.concur.ca,www.concur.dk,www.concur.fr,www.concur.de,www.concur.com.hk,www.concur.it,www.concur.co.jp,www.concur.kr,www.concur.com.mx,www.concur.nl,www.concur.no,www.concur.co.za,www.concur.es,www.concur.se,www.concur.co.uk,www.concur.com.sg,fundamentalconf.com,sqlasupport.sap.com/update_checker,courseducoeur.enter.sap,resolve.sap.com,videos.netshow.me,applicationstudio.sapcloud.cn,dcx.sap.com,career8.successfactors.com,go.support.sap.com,www.b-forum.net,www.green-token.io,.cp.iot.sap,hyperfair.com,events.sap.com,support.sap.com,www.wjx.cn,account.hana.ondemand.com,www.sap-latam.com,www.pathfactory.com,sapengineering.academy,orientdb.org,sap.scherer-event.com,www.sapevents.com,partner.store.sap.com,jobs.sap.com,relief.io,softwaredownloads.sap.com,saparena.de,salesselector.com,salesjibe.com,.learn.sap,s4hanaopp.com,gigyademo.com,sapvirtualevents.com,www.sapnow.com.br,orientdb.com,concur.com,fieldglass.com,gigya.com,successfactors.eu,sapanalytics.cloud,sapandasug.com,jam4.sapjam.com,saps4hanahub.com,sap.wegone.com,sapsupport.info,sapforum.it,sapappsdevelopmentpartnercenter.com,aribalive.com,concur.cn,concur.co.jp,concur.co.uk,concur.com.sg,sapsf.eu,mailsap.com,sapbydesign.com,yaas.io,sapsf.com,sapdigital.com,sapbusinessobjects.cloud,workconnect.io,digital.sap.com,sap.to,growthmattersnetwork.com,saplumira.com,sapappcenter.com,digitalistmag.com,hybris.com,the-future-of-commerce.com,sapmobileconsumertrends.com,sapeducationsolutions.com,sapns2.com,streamwork.com,sapstreamwork.com,aboutsapcampbell.com,analytics-usa.com,estara.com,businessobjects.com,businessobjects.com.pl,business-objects.com.pl,businessobjects.pl,business-objects.pl,careersatsap.com,cfolder.de,cfolders.com,cfolders.de,cfolders.net,crystalreports.com,digitalriver.com,edusap.at,fazi.at,fazi.com,fazi.de,futurefactoryinitiative.com,futurefactoryinitiative.org,fuzzy.at,fuzzy.ch,fuzzy-informatik.com,fuzzy-informatik.de,fuzzy-online.com,fuzzy-online.de,infommersion.com,ondemand.com,sap.at,sap.bg,sap.biz,sap.ca,sap.ch,sap.cl,sap.cn,sap.co.at,sap.co.il,sap.co.jp,sap.co.kr,sap.co.nz,sap.co.th,sap.co.uk,sap.co.za,sap.com,sap.com.au,sap.com.cn,sap.com.pl,sap.com.sg,sap.com.tr,sap.com.tw,sap.cz,sap.de,sap.ee,sap.fi,sap.hk,sap.hr,sap.hu,sap.ie,sap.in,sap.info,sap.kz,sap.lu,sap.nl,sap.pl,sap.pt,sap.ro,sap.ru,sap.si,sap.sk,sap.tw,sap.ua,sap.us,sapag.de,sap-ag.de,sapamerica.com,sap-answer.com,sap-austria.com,sap-best-fit-adviser.com,sapbusinessbydesign.cn,sapbusinessbydesign.co.uk,sapbusinessbydesign.com,sapbusinessbydesign.de,sapbusinessbydesign.us,sapbusinessobjects.com.pl,sap-business-objects.com.pl,sapbusinessobjects.pl,sap-business-objects.pl,sapbusinessobjectsresponses.com,sapbusinessone.pl,sap-campbell.com,sapcampbell.net,sapcampbell.org,sapchina.com,sapclear.com,sapconfigurator.com,sapdesignguild.org,sap-event.jp,sapevents.com,sap-forum.de,sap-insights.com,sapkhimetrics.com,saplabs.bg,saplabs.co.in,saplabs.fr,saplabs.in,sapnetweaver.com,sapphirenow.com,sap-retail.de,sapsapphire.com,sapsem.com,sap-spectrum.com,sapteched.com,sapthai.com,sapturkiye.com.tr,sap-tv.com,sapventures.com,sapworldtour.com,sapworldtour2010.com,steeb.de,sap.corp,saplabs.com,sybase.com,sappartneredge.eu,sapbusinessinthemoment.com,sapbusinessoptimizer.com,sapcampaigns.com,sapcfo.com,sapcpg.com,sapcrystalconfigurator.com,SAPEnterpriseMobility.mobi,sapevent.ch,sapfinancialservices.com,sapforumbimadrid2011.com,sap-im-dialog.com,sap-innovationnow.com,sap-it-leadership.com,sappartnermobileapps.com,sap-readytoboost.com,sapretailtoday.com,saprunprouder.com,sapsponsorships.com,sapstrategichr.com,sapsurvey.com,sapsustainabilitytoday.com,saputilitiestoday.com,sap-webseminare.de,iqformarketers.com,sybase.be,sybase.ca,sybase.ch,sybase.co.kr,sybase.co.uk,sybase.com.ar,sybase.com.au,sybase.com.br,sybase.com.cn,sybase.com.hk,sybase.com.mx,sybase.com.tw,sybase.de,sybase.dk,sybase.es,sybase.fr,sybase.hu,sybase.in,sybase.it,sybase.jp,sybase.nl,sybase.no,sybase.se,sybase365.com,sappartneredge.com,ariba.com,saphana.com,saphanacouncil.com,saphanapartnerrace.com,successfactors.co.kr,successfactors.com,successfactors.com.br,successfactors.com.cn,successfactors.de,successfactors.es,successfactors.jp,successfactors.nl,successfactors.se,sybase.asia,sybase.at,SYBASE.BIZ,sybase.co.at,sybase.co.hu,sybase.co.it,sybase.co.jp,sybase.co.ma,sybase.co.nz,sybase.co.za,sybase.com.ec,sybase.com.es,sybase.com.gr,sybase.com.my,sybase.com.pe,sybase.com.pk,sybase.com.pl,sybase.com.ro,sybase.com.sg,sybase.com.ve,sybase.cz,sybase.ec,sybase.ee,sybase.eu,sybase.hk,sybase.ie,sybase.info,sybase.li,sybase.lu,sybase.mobi,SYBASE.ORG,sybase.ph,sybase.pl,sybase.tw,sybase.us,sybasesolutions.net,syclo.co.uk,syclo.com,syclo.com.br,syclo.de,syclo.es,syclo.it,syclo.mobi,gainthevisibleadvantage.com,getconnected-sap.co.uk,myrunwayapp.com,sapafaria.com,saparpfasttrack.com,sapbusinessonnesolutions.com,sapcloudappspartnercenter.com,sapcustomerexerience.com,sapcycle4youth.com,sapdashboardgallery.com,sapdatacentertour.com,sapdatachallenge.com,sap-milestones.com,sap-milestones.de,sapmobileappspartnercenter.com,sapmobileservices.com,sapmobiletransformation.com,sap-sybase-ase.com,sap-sybase-iq.com,stepaheadwithsap.com,thinkbiggrowfast.net,sapbusinessobjectsbi.com,sapbigdata.com,www.sap.com'
    var filterTainted = taint(filters);
    var b = filterTainted.split(',');
    for (var i in b) {
        assertLastTaintOperationEquals(b[i], "split");
    }
}

runTaintTest(strSplitTest);
runTaintTest(strSplitTestArray);
runTaintTest(strSplitTestRegex);
runTaintTest(largeCommaSplit);
runTaintTest(largeCommaSplitTainted);

if (typeof reportCompare === 'function')
  reportCompare(true, true);
