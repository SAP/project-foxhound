<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <title>Check SessionStorage</title>
    <script src="/tests/SimpleTest/SimpleTest.js"></script>
    <script src="/tests/taint/test/mochitest/taint_helper.js"></script>
    <link rel="stylesheet" href="/tests/SimpleTest/test.css"/>
    <script "text/javascript">

    add_task(async function test_set_untainted_str() {
	    sessionStorage.setItem("untainted", "untainted string");
	    // Even untainted strings should be tainted as sessionStorage getItem is a source
	    check_tainted(sessionStorage.getItem("untainted"));
    });

    add_task(async function test_set_tainted_str() {
	    sessionStorage.setItem("tainted", String.tainted("tainted string"));
	    check_tainted(sessionStorage.getItem("tainted"));
    });
    </script>
  </head>

  <body>

</html>
